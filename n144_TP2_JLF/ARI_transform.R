###################################################################################################
##########################            GRMPY - Transform ARI              ##########################
##########################               Robert Jirsaraie                ##########################
##########################        rjirsara@pennmedicine.upenn.edu        ##########################
##########################                 03/22/2018                    ##########################
###################################################################################################
#####  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  #####
###################################################################################################
# Use #

# This script was created to do sensitivity analysis on the GRMPY dataset to test how the output would change
# if the heavily skewed ARI varible were trasnformed or subjects were removed to make more normally distributed. 

###################################################################################################
#####  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  #####
###################################################################################################

###########################################################
##### Read In ARI Data and Select Columns of Interest #####
###########################################################

ari<-read.csv("/data/jux/BBL/projects/jirsaraieStructuralIrrit/data/n144_TP2_JLF/n144_Irritability_20180322.csv")
ari$ari_naflag<-NULL

#########################################################################
##### Make New Variable that Excludes Subjects with no Irritability #####
#########################################################################

ari$ari_reduced <- ari$ari_total

ari$ari_reduced[ari$ari_reduced ==0] <- NA

hist(ari$ari_reduced)

#########################################################
##### Make New Variable Excluded of ARI Transformed #####
#########################################################

shapiro.test(ari$ari_total)

ari$ari_log <- log(ari$ari_log+1)

hist(ari$ari_log)

#################################
##### Write Out New Dataset #####
#################################

write.csv(ari, "/data/jux/BBL/projects/jirsaraieStructuralIrrit/data/n144_TP2_JLF/n144_Irritability_20180322.csv")

###################################################################################################
#####  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  ⚡  #####
###################################################################################################
